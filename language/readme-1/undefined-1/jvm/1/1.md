# 1장 - 자바 기술 시스템 소개

## 1.1 들어가며&#x20;

### 자바의 대표적인 특징&#x20;

* 하드웨어 플랫폼이라는 족쇄를 제거하여, "한 번 작성하면 어디서든 실행된다" 라는 이상을 실현한다.&#x20;
  * C, C++ 같은 언어들은 컴파일 시 바로 기계어로 번역되어 운영체제에 종속적인 실행 체계를 갖는다.&#x20;
  * JVM 이라는 중간에 머신을 사용해 컴파일 시 JVM 이 이해할 수 있는 언어로 컴파일 하고 JVM 에서 실제로 운영체제에 종속되는 기계어로 번역해 사용한다. (컴파일 + 인터프리터)&#x20;
  * JVM 언어는 운영체제에 종속적이지 않다.&#x20;
* 상당히 안전한 메모리 관리 시스템을 갖춘 덕분에 메모리 누수와 엉뚱한 메모리를 가리키는 문제를 대부분 해결한다.&#x20;
* 런타임에 핫 코드를 감지, 컴파일하고 최적화하여 자바 애플리케이션의 최상의 성능을 내도록 도와준다. (JIT 컴파일러)
  * 핫 코드 : 빈번하게 실행되어 전체 성능에 영향을 크게 주는 코드
* 표준 API 자체가 풍부할 뿐 아니라 수많은 기업과 오픈 소스 커뮤니티에서 제공하는 다양한 기능의 서드 파티 라이브러리를 활용할 수 있다.&#x20;

## 1.2 자바 기술 시스템&#x20;

전통적으로 자바 기술 시스템은 다음 요소들을 포괄한다.&#x20;

* **자바 프로그래밍 언어**&#x20;
* **(다양한 하드웨어 플랫폼용) 자바 가상 머신 구현**&#x20;
* 클래스 파일 포맷&#x20;
* **자바 클래스 라이브러리 API(표준 API)**&#x20;
* 다른 기업과 오픈 소스 커뮤니티에서 제공하는 서드 파티 클래스 라이브러리&#x20;

이 중 특히 자바 프로그래밍 언어, 자바 가상 머신, 자바 클래스 라이브러리를 묶어 JDK 라고 한다. \
(JDK 는 자바 프로그램 개발에 필요한 최소한의 환경이다)

또 JDK 는 자바 기술 시스템 전체 세대를 지칭할 때도 자주 쓰인다.&#x20;

자바 SE API, JVM, 배포 기술까지 묶어서 JRE 라고 표현하기도 한다. \
(JRE 는 자바 프로그램을 실행할 수 있는 표준 환경을 제시한다)

#### 제품군&#x20;

* 자바 카드&#x20;
* 자바 ME&#x20;
* 자바 SE : 데스크톱 애플리케이션용 자바 플랫폼, 완전한 형태의 자바 핵심 API 제공&#x20;
* 자바 EE&#x20;

현시점에서는 자바 SE 를 제외하고는 힘을 잃어가고 있다.

## 1.4 자바 가상 머신 제품군&#x20;

많은 자바 개발자가 자바 가상 머신을 오라클 JDK 의 핫스팟 가상 머신과 동일시한다. \
(점유율이 가장 높으니까..)&#x20;

대다수는 구체적인 제품명이 아니라, 전체를 그저 '자바 가상 머신'으로 인식한다.&#x20;

이번 장에서는 다양한 자바 가상 머신 제품군을 살펴보자.&#x20;

### 1.4.1 가상 머신의 조상 : 썬 클래식 VM, 이그잭트 VM&#x20;

썬 클래식 VM 은 매우 원시적이며 역할도 이미 오래전에 끝났다. 하지만 '세계 최초 상용 자바 가상 머신' 이라는 타이틀만으로도 역사의 한 줄을 장식할 자격은 충분하다.&#x20;

해당 가상머신은 자바 코드를 순전히 인터프리터 방식으로 실행했다. JIT 컴파일러를 사용하려면 플러그인으로 추가하면 됐는데, 플로그인하는 순간 가상 머신의 실행 시스템 전체가 JIT 컴파일러에 넘어가는 구조였다. 즉, 인터프리터는 더 이상 동작하지 않았다.&#x20;

당시 인터프리터와 컴파일러(JIT)는 함께 구동되지 않았기 때문에, 컴파일러를 사용하기 시작하면 실행 빈도 등 컴파일에 따른 득실과 상관 없이 '코드 전체' 를 컴파일해야 했다. 그래서 자칫하면 프로그램 응답 속도가 매우 느려지므로 오래 걸리는 최적화 기법은 적용할 수 없었다. 이 차이 때문에, '자바 언어는 느리다' 라는 인상이 개발자들 사이에서 있었다.&#x20;

이그잭트 VM 은 썬 클래스 VM 의 효율성 문제를 해결하기 위해서 개발되었으나 핫스팟 VM 에 의해 단명했다.

### 1.4.2 일인자 : 핫스팟 VM&#x20;

썬, 오라클 JDK, Open JDK 의 기본 가상 머신이자 가장 널리 사용되는 자바 가상 머신이다.&#x20;

핫스팟 VM 은 기존 사용 가상 머신의 장점을 계승하면서 새로운 기술적 진보를 이뤄내었다. 대표적인 기술은 '핫스팟'이란 이름을 탄생 시킨 핫 코드 감지(hot code detection) 기술이다.&#x20;

핫 코드 감지 기능은 '컴파일했을 때 효과를 가장 크게 볼 수 있는 코드 영역' 을 런타임에 알아내어서 JIT 컴파일러에게 알려준다. 그러면 JIT 컴파일러가 해당 코드를 메서드 단위로 컴파일한다. (핫 코드는 JIT 컴파일러가 캐시해서 사용한다)&#x20;

이렇게 되면 컴파일러와 인터프리터가 조화롭게 협력해 프로그램 응답 속도와 실행 성능 사이의 균형을 잡아주는 것이다.&#x20;

### 1.4.3 가난한 집의 고운 딸 : 모바일, 임베디드 VM&#x20;

해당 시장을 안드로이드와 IOS 가 양분했기 때문에, 해당 가상 머신을 사용하지는 않는다.&#x20;

### 1.4.4 이인자 : BEA JRockit, IBM J9 VM&#x20;

핫스팟 외에 제 2의 자바 가상 머신을 사용해 보고 싶다면 이클립스 테무린도 고려해보자. OpenJDK 라이브러리들에 OpenJ9 을 결합한 완전한 형태의 JDK 이다.&#x20;

등등 ..&#x20;

## 1.5 자바 기술의 미래&#x20;

### 1.5.1 언어 독립&#x20;

인터넷에서 이따금 '앞으로 자바를 대체할 언어' 라는 주제의 이야기를 볼 수 있다.&#x20;

주인공으로는 코틀린, 고, 자바스크립트, 파이썬 등이 자주 언급된다. 2020년대 들어서 자바는 3\~4위로 내려왔다.&#x20;

일반적으로 사용자 기반과 성숙한 소프트웨어 생태계 덕에 업계에서 자바의 중요도가 한순간에 바뀌기는 어렵다. 하지만, 새로운 시장을 등에 업고 다른 언어들이 성장해나가고 있다.&#x20;

2018 오라클 연구소는 그랄 VM 이라는 새로운 기술을 발표했다. 1995년에 자바가 만들어지면서 내건 구호인 "한 번 작성하면 어디서든 실행된다" 와 비슷하게 "어디서든 더 빠르게 실행한다" 라는 구호를 내걸었다.&#x20;

**그랄 VM 은 핫스팟 가상 머신 위에 구축된 크로스 언어 풀 스택 가상 머신이다.** 대부분의 언어(네이티브 언어, JVM 기반 언어 등등.. )가 그랄 VM 에서는 추가 비용 없이 이 언어들을 혼합해 사용할 수 있다. 서로 다른 언어들이 데이터를 같은 메모리 공간에서 주고받을 수 있고, 각 언어용으로 작성된 기존 네이티브 라이브러리들도 사용할 수 있다.&#x20;

그랄 VM 은 기본적으로 각종 언어의 소스 코드나 컴파일된 중간 형식(LLVM 비트코드 : JVM 바이트코드와 비슷한 개념) 을 인터프리터를 통해 그랄 VM 이 이해할 수 있는 중간 표현(IR)으로 변관하는 식으로 작동한다.&#x20;

* 예를 들어, 이 인터프리터는 LLVM 이 출력한 비트코드를 적절히 변환하여 그랄 VM 이 C, C++ 언어를 지원할 수 있게 해준다.&#x20;

그랄 VM 은 JVM 로 사용할 수 있다. 애초에 핫스팟 VM 을 기반으로 탄생했기 때문에, 자바 SE 와 완벽하게 호환된다. 표준 핫스팟 VM 과의 차이는 주로 JIT 컴파일러에서 오며, 현재 실행 효율과 컴파일 품질 모두 표준 핫스팟 VM 보다 나은 것으로 평가된다.&#x20;

오라클 연구소와 여러 미국 대학에서 수행한 최신 JIT 컴파일 연구가 모두 그랄 VM 으로 마이그레이션되는 등 발전 가능성이 매우 높다. 언젠가 자바 언어나 핫스팟 VM 이 완벽하게 대체된다면, 현재로써는 가장 유력한 후보가 바로 그랄 VM 이다.&#x20;

<figure><img src="../../../../../.gitbook/assets/스크린샷 2025-07-10 13.48.02.png" alt=""><figcaption></figcaption></figure>

### 1.5.2 차세대 JIT 컴파일러&#x20;

서버용 제품처럼 장기간 운용되는 애플리케이션에서는 자주 실행되는 핫 코드를 탐지하여 네이티브 코드로 컴파일한다. 이런 유형의 자바 애플리케이션은 JIT 컴파일러의 출력 품질이 실행 효율을 크게 좌우할 수 밖에 없다.&#x20;

핫스팟 VM 은 기본적으로 JIT 컴파일러를 2개 내장하고 있다.&#x20;

* 하나는 컴파일 속도가 빠른 대신 최적화를 적게 하는 클라이언트 컴파일러(C1)&#x20;
* 다른 하나는 컴파일 속도는 느리지만 더 많은 최적화를 적용하는 서버 컴파일러(C2) 이다.&#x20;
* 여기에 인터프리터까지 포함하여 총 3개의 실행 매커니즘이 협력하여 핫스팟 가상 머신의 실행 서브시스템을 구성한다.&#x20;

JDK10 부터는 하나가 더 추가되었다. 바로 그랄 컴파일러이다. 앞 절에서 이야기한 그랄 VM 프로젝트의 일환으로 만들어진 기술이다. 그랄 컴파일러는 C2 컴파일러를 대체할 목적으로 핫스팟 VM 에 도입되었다.&#x20;

C2 의 역사는 매우 오래되었고, 현재는 개발자 자신도 지속하기 어렵다고 할 정도록 복잡도가 올라간 상태이다. 이에 대한 대체재의 필요성이 대두되었고 그랄 VM 이 그에 대한 적임자가 되었다.&#x20;

그랄 컴파일러는 자바로 작성되었고, 컴파일된 코드의 출력 품질은 더 좋게 유지하면서 개발 효율과 확장성 측면에서는 C2 와 비교할 어려울 만큼 훌륭하다.&#x20;

JDK16 부터는 개발과 관리 효율을 높이고자 그랄 컴파일러를 JDK 에서 독립 시켜서 그랄 VM 으로 터전을 옮겼다.&#x20;

* JDK 10 \~ 15 에서는 별도의 옵션을 통해서 그랄 컴파일러가 사용 가능하다.&#x20;

비록 공식 JDK 에서는 없어졌지만, 그렇다고 위상이 내려갔다고 보기는 어렵다. 그랄 VM 은 오라클이 정식으로 지원하는 상용 제품군이며 일반 JDK 에서는 볼 수 없는 미래 지향적 기술이 많이 포함되어 있다.&#x20;

그리고 마침내 그랄 컴파일러가 OpenJDK 로 복귀한다는 소식이 전해졌다. 그랄 VM 의 여러 선진 기술 중 JIT 컴파일러와 네이티브 이미지를 OpenJDK 에 우선 반영하기로 한 것이다. (아직 반영 된 것은 아니다. 이러한 움직임이 보인다는 것이다)&#x20;

<figure><img src="../../../../../.gitbook/assets/스크린샷 2025-07-10 14.11.41.png" alt=""><figcaption></figcaption></figure>

### 등등 ..&#x20;
