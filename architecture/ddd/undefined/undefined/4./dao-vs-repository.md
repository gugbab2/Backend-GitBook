# DAO vs Repository

## 1. DAO&#x20;

### 특징&#x20;

* DAO 는 데이터베이스 혹은 다른 영속성 매커니즘에 대한 추상화해주는 역할을 수행한다.
  * DB 벤더별로 DAO 인터페이스를 상속받아서 구현을 하게 되고,
  * 이를 통해, 확장성 있는 설계가 가능하다.
* 전통적으로 CRUD 작업과 같은 로우 레벨의 데이터 작업에 중점을 둔다.
* 특정한 테이블이나 데이터 소스에 대해 직접적인 작업을 수행하는 방법을 제공한다.
* DAO 가 DB 를 사용한다면 보통 DB 테이블과의 1:1 매핑을 책임으로 가진다.

### 주요 역할

* SQL 쿼리 실행&#x20;
* JDBC, JPA, MyBatis 와 같은 데이터 엑세스 기술을 사용하여 데이터 소스와 상호작용.&#x20;
* 데이터베이스 테이블과 1:1 매핑되는 구조를 가질 때가 많다.&#x20;

```java
public class UserDao {
    private DataSource dataSource;

    public UserDao(DataSource dataSource) {
        this.dataSource = dataSource;
    }

    public User findById(Long id) {
        String query = "SELECT * FROM users WHERE id = ?";
        // JDBC로 SQL 실행
    }

    public void save(User user) {
        String query = "INSERT INTO users (name, email) VALUES (?, ?)";
        // JDBC로 SQL 실행
    }

    // Update, Delete 등 다른 CRUD 메서드들...
}
```

### 장단점

#### 장점&#x20;

* 데이터 접근 로직이 캡슐화되어 코드 재사용성과 유지보수성이 높아진다.&#x20;
* 데이터 소스 변경(JDBC -> JPA) 이 필요한 경우 변경 범위가 좁아진다.&#x20;

#### 단점&#x20;

* 테이블 중심으로 설계되기 때문에 도메인 객체와의 매핑이 부족하거나, 비지니스 로직이 분리되지 않을 수 있다.&#x20;

## 2. Repository

### 특징

* Repoisitory 는 도메인 모델 중심으로 설계된 데이터 접근 계층이다.&#x20;
* 데이터 소스의 구체적인 구현 세부사항을 숨기며, 비즈니스 로직이 필요로 하는 도메인 객체의 컬렉션처럼 동작한다.&#x20;
* DDD 에서 도메인 계층과 데이터 계층 간의 다리 역할을 한다.&#x20;

### 주요 역할&#x20;

* 데이터베이스, 캐시, 원격 API 등 다양한 데이터 소스로부터 데이터를 관리하고 제공&#x20;
* 비즈니스 요구사항을 만족하기 위한 고수준의 데이터 조작을 제공&#x20;
  * 단순하게 테이블별로 CRUD 를 만드는 것이 아니라,&#x20;
  * 애그리거트 별로 필요한 DB 사용 기능을 만드는 것에 초점이 맞추어져 있다.&#x20;

### 장단점&#x20;

#### 장점&#x20;

* 데이터 소스의 구체적인 구현에 신경 쓸 필요 없이, 고수준(애그리거트 기준)의 비지니스 작업을 수행할 수 있다.&#x20;
* 데이터베이스와 무관한 도메인 모델 중심의 설계를 촉진한다.&#x20;
* Spring Data JPA 와 같은 프레임워크를 사용하면 CURD 메서드를 자동 생성해 생산성을 높일 수 있다.&#x20;

#### 단점&#x20;

* 도메인 중심 설계에 익숙하지 않은 팀에서는 적합하지 않을 수 있다.&#x20;
  * 만약 Repository 를 DAO 처럼 사용한다면, 의미없는 일이다..&#x20;
* 특정 데이터 소스나 프레임워크에 종속될 가능성이 있다.&#x20;

## 3. 설계시 고려사항&#x20;

### DAO 를 선택할 경우&#x20;

* 테이블 중심의 데이터 접근이 필요할 때.&#x20;
* 데이터 소스와의 저수준 작업(SQL, JDBC 등) 을 명확히 해야 할 때.&#x20;
* DDD 가 필요 없을 때&#x20;

### Repository 를 선택할 경우&#x20;

* DDD 가 필요할 때&#x20;
* 데이터베이스 뿐만 아니라, 다른 소스(API, 캐시 등) 에서 데이터를 가져오는 추상화를 원할 때.&#x20;
* DDD 를 적용하고자 할 때.&#x20;
