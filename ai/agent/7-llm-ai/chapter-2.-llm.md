# chapter 2. LLM 기반의 에이전트 기술 기반 체계

## 2.1 에이전트 네가지 핵심 요소&#x20;

에이전트가 중심에서 여러 구성 요소들을 협력하는 하는 것으로 복잡한 작업과 의사 결정 과정을 처리한다.&#x20;

* **계획(planing)**&#x20;
  * 에이전트는 복잡한 작업을 효과적으로 수행하기 위한 계획 능력과 의사 결정 능력이 필요하다.&#x20;
  * 여기에는 작은 목표로 분할, 사고의 연쇄, 자기 성찰과 비판, 과거 행동에 대한 성찰이 포함된다.&#x20;
* **기억(memory)**&#x20;
  * 단기 기억과 장기 기억의 두 부분으로 구성된다.
  * 단기 기억은 맥락 학습과 관련이 있는 프롬프트 엔지니어링의 일부이다.&#x20;
  * 장기기억은 정보의 장기 저장 및 검색과 관련이 있으며, **일반적으로 외부 벡터 스토리지와 빠른 검색을 활용한다.**&#x20;
* **도구(tool)**&#x20;
  * 에이전트가 호출할 수 있는 다양한 도구들을 포함한다.&#x20;
  * 예를 들어 달력, 계산기, 코드 해석기, 검색 기능 등이 여기에 해당된다.&#x20;
  * **LLM 은 사전학습이 완료되면 기본적으로 내부 능력과 지식의 한계가 해당 시점으로 고정되며 확장하기 어려운 특성을 지니므로, 이러한 도구들이 중요하다.**
* **실행(action)**&#x20;
  * 에이전트는 계획과 기억을 바탕으로 구체적인 행동을 실행한다.&#x20;
  * 여기에는 외부 세계와의 상호작용이나 도구를 하출하여 작업을 완료하는 것이 포함될 수 있다.&#x20;

### 에이전트 추론 흐름도&#x20;

1. 작업 수신 : 에이전트는 먼저 프롬프트를 통해 요청, 외부 추가 지식, 인물 설정을 읽어 작업을 수신한다.&#x20;
2. 기억 갱신 : 에이전트는 특정 작업에 따라 시스템의 기억을 갱신하여 처리 과정에서 필요한 모든 관련 정보를 최신 상태로 유지한다.&#x20;
3. 기억 검색 : 기억이 방대할 가능성이 있기 때문에 관련 정보를 검색하거나 필요한 경우 데이터를 잘라내어 효율적으로 처리할 수 있게 한다.&#x20;
4. 작업 계획 : LLM 은 이전 단계에서 제공된 구조화된 도구, 기억, 요청 프롬프트를 바탕으로 작업 이름을 포함한 계획을 생성한다. 이 계획은 후속 단계와 작업을 포함하고 있으며, 사용해야 할 도구와 매개변수를 설명한다.&#x20;
5. 도구 실행 : '작업 계획' 모듈에서 작업 완료 신호가 생성되면, 순환이 종료되고 에이전트에게 작업이 완료되었다고 알려 결론을 생성한다. 그렇지 않으면 시스템은 지정된 도구를 호출하고 실행한다. LLM 으느 도구가 생성한 지정된 형식의 결과를 관찰한 후 이를 작업 기억과 통합한다.&#x20;
6. 결론 도출 : 시스템은 최종 답변을 요약하고 작업 처리 과정을 마친다.&#x20;

## 2.2 에이전트의 계획 및 의사 결정 능력&#x20;

LLM 이 에이전트에게 부여하는 계획과 의사 결정 능력은 매우 중요하다.&#x20;

**계획은 복잡한 작업을 더 작고 관리하기 쉬운 하위 작업으로 분해하는 과정이다.** 이 과정은 우리가 작업을 더 잘 이해하고 완료하는데 도움을 준다.&#x20;

* 연구자들이 제안한 계획 기술에는 작업 분해, 외부 계획기와의 결합, 자기 성찰 등이 포함된다.&#x20;

**작업 분해에는 다음과 같은 기술이 포함되어 있다.**&#x20;

* 사고의 연쇄 : 이것은 모델이 '단계별로 생각하도록' 유도하는 프롬프트 기술로, 이를 통해 모델이 큰 작업을 작은 작업으로 분해하고 자신의 사고 과정을 명확하게 설명하게 할 수 있다.&#x20;
* 사고의 나무 : 각 단계에서 다양한 추론 가능성을 탐색함으로써 트리 구조를 형성한다. 사고의 나무는 BFS, DFS 과 같은 다양한 검색 방법을 사용할 수 있으며, 프롬프트나 투표를 통해 각 단계를 평가할 수 있다.&#x20;
* 이 외에도 간단한 프롬프트, 특정 작업에 대한 명령, 직접 수동을 분해하는 등의 방식으로 작업 분해를 수행할 수 있다.&#x20;

**외부 계획기와 결합을 대표하는 것은 'LLM+P' 방법이다.**&#x20;

* 본질적으로 계획 단계는 외부 도구에 위탁되며, 이러한 방법은 일부 로봇 설정에서 흔히 사용된다.&#x20;

**자기 성찰에는 다음 기술이 포함된다.**&#x20;

* ReAct : 이 기반 체계에는 특정 작업의 행동과 언어 공간을 결합하여 모델이 환경과 상호작용하고 추론 궤적을 생성할 수 있도록 한다.&#x20;
* Reflexion : 이 기반 체계는 에이전트가 동적 기억과 자기 성찰 능력을 갖출 수 있도록 한다. 이를 통해 에이전트는 과거의 행동을 회고하는 추론 능력을 향상시킬 수 있다.&#x20;
* CoH(chain of hindsight) : 이 방법은 LLM 에게 일련의 피드백이 포함된 과거 출력을 보여주고 이를 바탕으로 자신의 출력을 개선하도록 권장한다.&#x20;

이어서 **ReAct 기반 체계** / **도구 호출**이라는 에이전트의 핵심 기능 두 가지를 소개한다.&#x20;

ReAct 기방 체계는 대표적인 에이전트 추론 기반 체계로, 에이전트의 동적 성격과 적응성에 중점을 둔다. 에이전트는 ReAct 기반 체계에서 작업에 대한 추론을 할 수 있을 뿐 아니라 상황 변화에 따라 스스로 행동하고 조정할 수 있다. ReAct 기반 체계는 에이전트 설계에서 순환적인 상호작용 형태의 과정을 보여준다. **에이전트는 먼저 현재 상태를 감지하고, 그 결과에 따라 결정을 내리고 행동을 취하며 다시 행동의 결과와 그에 따른 상태 변화를 바탕으로 조정을 진행한다. 그리고 그 과정은 반복된다.** ReAct 기반 체계는 에이전트를 더 유연하게 바꾸고 더 강한 적응력을 부여해 복잡하고 변화무쌍한 환경에서도 효과적으로 작업할 수 있도록 한다.&#x20;

도구는 에이전트에 제공된 기능 함수, 코드 조각, 기타 기술 도구를 의미한다. 에이전트는 ReAct 기반 체계를 바탕으로 외부 도구를 사용해 작업이나 하위 작업을 해결하려고 계속 시도하는데, 도구가 호출될 때마다 새로운 결과와 상태 변화가 발생한다. 에이전트는 개발 과정에서 이러한 도구들은 에이전트의 능력을 강화하고 성능과 신뢰성을 보장하는 필수적인 자원과 편의를 제공한다.&#x20;

에이전트는 이 두 가지 결합을 통해 더 지능적이고 자율적으로 성장해가면서 적응력도 강해져 각 분야에 더 많은 가능성을 열어준다.&#x20;

## 2.3 에이전트의 다양한 기억 기제
