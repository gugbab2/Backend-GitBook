# Docker Volume 을 활용해 데이터 유실 방지하기

## Docker Volume

### 컨테이너가 가진 문제점&#x20;

도커를 활용하면 특정 프로그램을 컨테이너로 띄울 수 있다. 이 프로그램에 기능이 추가되면 새로운 이미지를 만들어서 컨테이너를 실행시켜야 한다. (다시 이미지 빌드 후, 이미지를 기반으로 컨테이너를 실행시킨다)&#x20;

&#x20;이때 도커는 기존 컨테이너에서 변경된 부분을 수정하지 않고, 새로운 컨테이너를 만들어서 갈아끼우는 방식으로 교체를 한다. 이게 효율적이라고 생각했던 것이다.&#x20;

이런 특징 때문에, 기존 컨테이너를 새로운 컨테이너로 교체하면, 기존 컨테이너 내부에 있던 데이터도 같이 삭제된다. 만약 이 컨테이너가 MySQL 을 실행시키는 컨테이너였다면, MySQL 에 저장된 데이터도 같이 삭제된다. \
(기존 컨테이너 내부에 데이터가 저장된다)

**따라서 컨테이너 내부에 저장된 데이터가 삭제되면 안되는 경우에는 볼륨(Volume) 이라는 개념을 활용해야 한다.**&#x20;

### Docker Volume 이란?&#x20;

도커 볼륨이란 **도커 컨테이너에서 데이터를 영속적으로 저장하기 위한 방법이다.** 볼륨은 컨테이너 자체의 저장 공간을 사용하지 않고, 호스트 자체의 저장 공간을 공유해서 사용하는 형태이다.&#x20;

### 볼륨을 사용하는 명령어&#x20;

```shellscript
docker run -v [호스트의 디렉토리 절대경로]:[컨테이너의 디렉토리 절대경로] [이미지명]:[태그명]
```

* `[호스트의 디렉토리 절대경로]` 에 디렉토리가 존재할 경우, 호스트의 디렉토리가 컨테이너의 디렉토리를 덮어 씌운다.&#x20;
* `[호스트의 티렉토리 절대경로]` 에 디렉토리가 존재하지 않을 경우, 호스트의 디렉토리 절대 경로에 디렉토리를 새로 만들고 컨테이너의 디렉토리에 있는 파일들을 호스트의 디렉토리로 복사해온다.&#x20;

#### MySQL 볼륨 사용 예시

```shellscript
cd /Users/jaeseong/Documents/Develop
mkdir docker-mysql # MySQL 데이터를 저장하고 싶은 폴더 만들기

# docker run -e MYSQL_ROOT_PASSWORD=password123 -p 3306:3306 -v {호스트의 절대경로}/mysql_data:/var/lib/mysql
docker run -e MYSQL_ROOT_PASSWORD=password123 -p 3306:3306 -v /Users/jaeseong/Documents/Develop/docker-mysql:/var/lib/mysql -d mysql
```
